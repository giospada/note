---
tags: [Computer]
title: Malware
created: '2020-02-18T14:12:51.822Z'
modified: '2020-05-30T17:01:44.969Z'
---

# Malware

## 0 Introduction


### GOALS OF MALWARE ANALYSIS 

cercare una firma che può essere
- <b>Host-based signatures </b>: sono indicatori come file creati/cancellati/modificati o modifiche alle registy(si basa sulle caratteristiche)
 
- <b>Network signatures </b>: sono indicatori che si hanno dalla analisi del traffico


### Malware Analysis Techniques
- <b> Basic Static Analysis</b> : l'analisi senza eseguirlo 
- <b> Dynamic Static Analysis</b>: l'analisi fa eseguire il malware


#### Static Analysis
<b>Basic</b>
cerca di capirlo in base alle funzioionalità
<b>Advanced</b>
include il reversing 


#### Dynamic Analysis
<b>Basic</b>
esegue il malware e guarda il suo comportamento 
<b>Advanced</b>
usa il debugger per vedere gli internal 


### Types of Malware
- Backdoor (accesso remoto)
- Botnet (Backdoor su più computer)
- Downloader (codice che scarica altro codice e lo installa)
- Information-stealing (collezzione informazioni e le manda all'attaccante)
- Launcher (programmi che lanciano altri malware)
- Rootkit (sono solo più difficili da trovare)
- Scareware (fanno finta di essere antivirus)
- Spam-sending
- Worm or virus (malware che si copiano)



## 1 BASIC STATIC TECHNIQUES

<b>search with antimalware</b>  

 <b>search for strings</b> : sia per ascii( un byte per ogni char) sia unicode ( due byte per ogni char per i caratteri ascii il secondo byte è zero) es ASCII "B" -> .0x42. .0x00. , Unicode "B" -> 0x42.0x00 0x00.0x00 

> NOTE
Packed and obfuscated code will often include at least the functions LoadLibrary and
GetProcAddress , which are used to load and gain access to additional functions.

<b>Packing Files</b>
quando viene eseguito si decodidfica e si esegue
> Tool PEiD, UPX

### Portable Executable File Format
PE è la struttura dell'eseguibile di windows/ object code / DLL

<b>Static, Runtime, and Dynamic LinkingLibraries</b>
- <b>Static</b>: quando il codice è compiato nel eseguibile
- <b>runtime linking</b>: si connettono a librerie solo quando gli servono (funzion usate : LoadLibrary , GetProcAddress, LdrGetProcAddress,LdrLoadDll,LoadLibrary, GetProcAddress)
- <b>dynamic linking </b> il più comumne si linka alle librerie quando il programma viene caricato in memoria

> Tool Dependency Walker 
è un programma per analizzare le librerie importate dinamicamente


librery | Description
:-----:|:-----:
Kernel32.dll |This is a very common DLL that contains core functionality, such as accessand manipulation of memory, files, and hardware.
Advapi32.dll |This DLL provides access to advanced core Windows components suchas the Service Manager and Registry.
User32.dll |This DLL contains all the user-interface components, such as buttons, scrollbars, and components for controlling and responding to user actions.
Gdi32.dll |This DLL contains functions for displaying and manipulating graphics.
Ntdll.dll |This DLL is the interface to the Windows kernel. Executables generally donot import this file directly, although it is always imported indirectly by
Kernel32.dll.| If an executable imports this file, it means that the author intended to use functionality not normally available to Windows pro-grams. Some tasks, such as hiding functionality or manipulating pro-cesses, will use this interface.
WSock32.dll and Ws2\_32.dll |These are networking DLLs. A program that accesses either of these most likely connects to a network or performs network-related tasks.
Wininet.dll |This DLL contains higher-level networking functions that implement protocols such as FTP, HTTP, and NTP.

> NOTE GUARDA SEMPRE LA IMPORT AND EXPORT TABLE

### The PE File Headers and Sections
the header contain metadata abaut the file 
section|Description
:---:|:---:
.text| contiene le istruzioni del programma
.rdata| read-only data 
.data| contiene le variabili globali 
.idata|  import  table
.edata| export table
.pdata| exception handling information
.rsrc| contiene le risorse come icone etc.. e stringe
.reloc| multilanguage support

> Tool PEview mostra informazioni sull header






